import './thirdFloor.css';
import React, { Component } from 'react';
import axios from 'axios';
import Tippy from '@tippy.js/react';
import 'tippy.js/dist/tippy.css';
require('es6-promise').polyfill();

class EleventhFloor extends Component {


    constructor(props) {
        super(props)
        this.state = {
            isLoaded: false,
            rooms: []
        }
    }



    componentDidMount() {
        this.fetchData();
        this.interval = setInterval(() => {
            this.fetchData();
        }, 10000)
    }

    fetchData() {
        axios.get(`https://findhuddle-api.azurewebsites.net/api/devices/HRH/11`)
            .then(res => {
                this.setState({
                    isLoaded: true,
                    rooms: res.data,
                })
                console.log("fetched")
            }).catch(err => {
                console.log("error")
            })
    }

    render() {
        var { isLoaded, rooms } = this.state;

        if (!isLoaded) {
            return <div>Loading...</div>

        }

        else {
            return (
                <div>
                    <div>
                        <h3 className="building">HRH 11th Floor</h3>

                        <div className="Wrap">
                            <table>
                                <tbody>
                                    <tr>
                                        <td className="Svg"> <svg width="550" height="650" viewBox="0 0 666 729" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <rect x="2" y="2.00006" width="662" height="725" fill="#EEF4FA" stroke="black" strokeWidth="4" />
                                            <rect x="113" y="505" width="205" height="222" fill="#CBE0F4" stroke="black" strokeWidth="4" />
                                            <path d="M165.856 601.048V606.64H171.952V608.44H165.856V614.2H172.672V616H163.672V599.248H172.672V601.048H165.856ZM178.161 598.24V616H175.977V598.24H178.161ZM193.883 608.92C193.883 609.336 193.859 609.776 193.811 610.24H183.299C183.379 611.536 183.819 612.552 184.619 613.288C185.435 614.008 186.419 614.368 187.571 614.368C188.515 614.368 189.299 614.152 189.923 613.72C190.563 613.272 191.011 612.68 191.267 611.944H193.619C193.267 613.208 192.563 614.24 191.507 615.04C190.451 615.824 189.139 616.216 187.571 616.216C186.323 616.216 185.203 615.936 184.211 615.376C183.235 614.816 182.467 614.024 181.907 613C181.347 611.96 181.067 610.76 181.067 609.4C181.067 608.04 181.339 606.848 181.883 605.824C182.427 604.8 183.187 604.016 184.163 603.472C185.155 602.912 186.291 602.632 187.571 602.632C188.819 602.632 189.923 602.904 190.883 603.448C191.843 603.992 192.579 604.744 193.091 605.704C193.619 606.648 193.883 607.72 193.883 608.92ZM191.627 608.464C191.627 607.632 191.443 606.92 191.075 606.328C190.707 605.72 190.203 605.264 189.563 604.96C188.939 604.64 188.243 604.48 187.475 604.48C186.371 604.48 185.427 604.832 184.643 605.536C183.875 606.24 183.435 607.216 183.323 608.464H191.627ZM201.662 613.984L205.742 602.848H208.07L202.91 616H200.366L195.206 602.848H197.558L201.662 613.984ZM209.403 609.376C209.403 608.032 209.675 606.856 210.219 605.848C210.763 604.824 211.507 604.032 212.451 603.472C213.411 602.912 214.475 602.632 215.643 602.632C216.795 602.632 217.795 602.88 218.643 603.376C219.491 603.872 220.123 604.496 220.539 605.248V602.848H222.747V616H220.539V613.552C220.107 614.32 219.459 614.96 218.595 615.472C217.747 615.968 216.755 616.216 215.619 616.216C214.451 616.216 213.395 615.928 212.451 615.352C211.507 614.776 210.763 613.968 210.219 612.928C209.675 611.888 209.403 610.704 209.403 609.376ZM220.539 609.4C220.539 608.408 220.339 607.544 219.939 606.808C219.539 606.072 218.995 605.512 218.307 605.128C217.635 604.728 216.891 604.528 216.075 604.528C215.259 604.528 214.515 604.72 213.843 605.104C213.171 605.488 212.635 606.048 212.235 606.784C211.835 607.52 211.635 608.384 211.635 609.376C211.635 610.384 211.835 611.264 212.235 612.016C212.635 612.752 213.171 613.32 213.843 613.72C214.515 614.104 215.259 614.296 216.075 614.296C216.891 614.296 217.635 614.104 218.307 613.72C218.995 613.32 219.539 612.752 219.939 612.016C220.339 611.264 220.539 610.392 220.539 609.4ZM229.102 604.648V612.4C229.102 613.04 229.238 613.496 229.51 613.768C229.782 614.024 230.254 614.152 230.926 614.152H232.534V616H230.566C229.35 616 228.438 615.72 227.83 615.16C227.222 614.6 226.918 613.68 226.918 612.4V604.648H225.214V602.848H226.918V599.536H229.102V602.848H232.534V604.648H229.102ZM240.916 616.216C239.684 616.216 238.564 615.936 237.556 615.376C236.564 614.816 235.78 614.024 235.204 613C234.644 611.96 234.364 610.76 234.364 609.4C234.364 608.056 234.652 606.872 235.228 605.848C235.82 604.808 236.62 604.016 237.628 603.472C238.636 602.912 239.764 602.632 241.012 602.632C242.26 602.632 243.388 602.912 244.396 603.472C245.404 604.016 246.196 604.8 246.772 605.824C247.364 606.848 247.66 608.04 247.66 609.4C247.66 610.76 247.356 611.96 246.748 613C246.156 614.024 245.348 614.816 244.324 615.376C243.3 615.936 242.164 616.216 240.916 616.216ZM240.916 614.296C241.7 614.296 242.436 614.112 243.124 613.744C243.812 613.376 244.364 612.824 244.78 612.088C245.212 611.352 245.428 610.456 245.428 609.4C245.428 608.344 245.22 607.448 244.804 606.712C244.388 605.976 243.844 605.432 243.172 605.08C242.5 604.712 241.772 604.528 240.988 604.528C240.188 604.528 239.452 604.712 238.78 605.08C238.124 605.432 237.596 605.976 237.196 606.712C236.796 607.448 236.596 608.344 236.596 609.4C236.596 610.472 236.788 611.376 237.172 612.112C237.572 612.848 238.1 613.4 238.756 613.768C239.412 614.12 240.132 614.296 240.916 614.296ZM252.716 604.984C253.1 604.232 253.644 603.648 254.348 603.232C255.068 602.816 255.94 602.608 256.964 602.608V604.864H256.388C253.94 604.864 252.716 606.192 252.716 608.848V616H250.532V602.848H252.716V604.984ZM264.141 616.216C263.133 616.216 262.229 616.048 261.429 615.712C260.629 615.36 259.997 614.88 259.533 614.272C259.069 613.648 258.813 612.936 258.765 612.136H261.021C261.085 612.792 261.389 613.328 261.933 613.744C262.493 614.16 263.221 614.368 264.117 614.368C264.949 614.368 265.605 614.184 266.085 613.816C266.565 613.448 266.805 612.984 266.805 612.424C266.805 611.848 266.549 611.424 266.037 611.152C265.525 610.864 264.733 610.584 263.661 610.312C262.685 610.056 261.885 609.8 261.261 609.544C260.653 609.272 260.125 608.88 259.677 608.368C259.245 607.84 259.029 607.152 259.029 606.304C259.029 605.632 259.229 605.016 259.629 604.456C260.029 603.896 260.597 603.456 261.333 603.136C262.069 602.8 262.909 602.632 263.853 602.632C265.309 602.632 266.485 603 267.381 603.736C268.277 604.472 268.757 605.48 268.821 606.76H266.637C266.589 606.072 266.309 605.52 265.797 605.104C265.301 604.688 264.629 604.48 263.781 604.48C262.997 604.48 262.373 604.648 261.909 604.984C261.445 605.32 261.213 605.76 261.213 606.304C261.213 606.736 261.349 607.096 261.621 607.384C261.909 607.656 262.261 607.88 262.677 608.056C263.109 608.216 263.701 608.4 264.453 608.608C265.397 608.864 266.165 609.12 266.757 609.376C267.349 609.616 267.853 609.984 268.269 610.48C268.701 610.976 268.925 611.624 268.941 612.424C268.941 613.144 268.741 613.792 268.341 614.368C267.941 614.944 267.373 615.4 266.637 615.736C265.917 616.056 265.085 616.216 264.141 616.216Z" fill="black" />
                                            <rect x="258" y="419" width="60" height="44" fill="#CBE0F4" stroke="black" strokeWidth="4" />
                                            <rect x="2" y="419" width="111" height="308" fill="#CBE0F4" stroke="black" strokeWidth="4" />
                                            <rect x="318" y="419" width="114" height="248" fill="#CBE0F4" stroke="black" strokeWidth="4" />
                                            <rect x="32" y="2.00006" width="128" height="245" fill="#CBE0F4" stroke="black" strokeWidth="4" />
                                            <rect x="249" y="381" width="87" height="191" transform="rotate(-90 249 381)" fill="#CBE0F4" stroke="black" strokeWidth="4" />
                                            <rect x="-2.00217" y="-2" width="131" height="209.743" transform="matrix(-1 0 -0.00108631 -0.999999 409.225 271.743)" fill="#CBE0F4" stroke="black" strokeWidth="4" />
                                            <rect x="280" y="44" width="42" height="200" transform="rotate(-90 280 44)" fill="#CBE0F4" stroke="black" strokeWidth="4" />
                                            <rect x="210" y="294" width="87" height="178" transform="rotate(90 210 294)" fill="#CBE0F4" stroke="black" strokeWidth="4" />
                                            <rect x="506" y="44" width="129" height="652" fill="#CBE0F4" stroke="black" strokeWidth="4" />
                                            <rect x="113" y="419" width="88" height="86" fill="#CBE0F4" stroke="black" strokeWidth="4" />
                                            
                                            <Tippy content="HD110004">
                                                <path key="HD110004" d="M164 419H201V459H164V419Z" stroke="black" strokeWidth="4"
                                                 fill={new Date() - new Date(rooms[0].lastOnline) > 300000 ? ("#559F3B") : ("#DD0F0F")}  />
                                            </Tippy>
                                            <Tippy content="HD110016">
                                                <path key="HD110016" d="M280 463H318V505H280V463Z" stroke="black" strokeWidth="4" 
                                                 fill={new Date() - new Date(rooms[1].lastOnline) > 300000 ? ("#559F3B") : ("#DD0F0F")}  />
                                            </Tippy>
                                            <Tippy content="HD110008">
                                                <path key="HD110008" d="M479 2H521V44H479V2Z" stroke="black" strokeWidth="4"
                                                 fill={new Date() - new Date(rooms[2].lastOnline) > 300000 ? ("#559F3B") : ("#DD0F0F")}  />
                                            </Tippy>
                                            <Tippy content="HD110011">
                                                <path key="HD110011" d="M281 273.629V229.002L324 229.049V273.676L281 273.629Z" stroke="black" strokeWidth="4"
                                                 fill={new Date() - new Date(rooms[3].lastOnline) > 300000 ? ("#559F3B") : ("#DD0F0F")}  />
                                            </Tippy>
                                            <Tippy content="HD110012">
                                                <path key="HD110012" d="M324 273.833V229.002L365 229.047V273.878L324 273.833Z" stroke="black" strokeWidth="4"
                                                 fill={new Date() - new Date(rooms[4].lastOnline) > 300000 ? ("#559F3B") : ("#DD0F0F")}  />
                                            </Tippy>
                                            <Tippy content="HD110010">
                                                <path key="HD110010" d="M281 229.207V185.002L324 185.049V229.254L281 229.207Z" stroke="black" strokeWidth="4"
                                                 fill={new Date() - new Date(rooms[5].lastOnline) > 300000 ? ("#559F3B") : ("#DD0F0F")}  />
                                            </Tippy>

                                            <path d="M241.884 490.116C241.396 489.628 240.604 489.628 240.116 490.116L232.161 498.071C231.673 498.559 231.673 499.351 232.161 499.839C232.649 500.327 233.441 500.327 233.929 499.839L241 492.768L248.071 499.839C248.559 500.327 249.351 500.327 249.839 499.839C250.327 499.351 250.327 498.559 249.839 498.071L241.884 490.116ZM242.25 527V491H239.75V527H242.25Z" fill="black" />
                                            <path d="M337.884 698.884C338.372 698.396 338.372 697.604 337.884 697.116L329.929 689.161C329.441 688.673 328.649 688.673 328.161 689.161C327.673 689.649 327.673 690.441 328.161 690.929L335.232 698L328.161 705.071C327.673 705.559 327.673 706.351 328.161 706.839C328.649 707.327 329.441 707.327 329.929 706.839L337.884 698.884ZM301 699.25H337V696.75H301V699.25Z" fill="black" />
                                            <path d="M216.664 472.786V476.98H221.236V478.33H216.664V482.65H221.776V484H215.026V471.436H221.776V472.786H216.664ZM229.06 473.956C230.26 473.956 231.232 474.322 231.976 475.054C232.72 475.774 233.092 476.818 233.092 478.186V484H231.472V478.42C231.472 477.436 231.226 476.686 230.734 476.17C230.242 475.642 229.57 475.378 228.718 475.378C227.854 475.378 227.164 475.648 226.648 476.188C226.144 476.728 225.892 477.514 225.892 478.546V484H224.254V474.136H225.892V475.54C226.216 475.036 226.654 474.646 227.206 474.37C227.77 474.094 228.388 473.956 229.06 473.956ZM237.766 475.486V481.3C237.766 481.78 237.868 482.122 238.072 482.326C238.276 482.518 238.63 482.614 239.134 482.614H240.34V484H238.864C237.952 484 237.268 483.79 236.812 483.37C236.356 482.95 236.128 482.26 236.128 481.3V475.486H234.85V474.136H236.128V471.652H237.766V474.136H240.34V475.486H237.766ZM243.962 475.738C244.25 475.174 244.658 474.736 245.186 474.424C245.726 474.112 246.38 473.956 247.148 473.956V475.648H246.716C244.88 475.648 243.962 476.644 243.962 478.636V484H242.324V474.136H243.962V475.738ZM257.535 474.136L251.595 488.644H249.903L251.847 483.892L247.869 474.136H249.687L252.783 482.128L255.843 474.136H257.535ZM263.279 472.48V470.986H266.663V484H265.007V472.48H263.279Z" fill="black" />
                                            <path d="M348.37 690.786V694.98H352.942V696.33H348.37V700.65H353.482V702H346.732V689.436H353.482V690.786H348.37ZM360.766 691.956C361.966 691.956 362.938 692.322 363.682 693.054C364.426 693.774 364.798 694.818 364.798 696.186V702H363.178V696.42C363.178 695.436 362.932 694.686 362.44 694.17C361.948 693.642 361.276 693.378 360.424 693.378C359.56 693.378 358.87 693.648 358.354 694.188C357.85 694.728 357.598 695.514 357.598 696.546V702H355.96V692.136H357.598V693.54C357.922 693.036 358.36 692.646 358.912 692.37C359.476 692.094 360.094 691.956 360.766 691.956ZM369.472 693.486V699.3C369.472 699.78 369.574 700.122 369.778 700.326C369.982 700.518 370.336 700.614 370.84 700.614H372.046V702H370.57C369.658 702 368.974 701.79 368.518 701.37C368.062 700.95 367.834 700.26 367.834 699.3V693.486H366.556V692.136H367.834V689.652H369.472V692.136H372.046V693.486H369.472ZM375.669 693.738C375.957 693.174 376.365 692.736 376.893 692.424C377.433 692.112 378.087 691.956 378.855 691.956V693.648H378.423C376.587 693.648 375.669 694.644 375.669 696.636V702H374.031V692.136H375.669V693.738ZM389.241 692.136L383.301 706.644H381.609L383.553 701.892L379.575 692.136H381.393L384.489 700.128L387.549 692.136H389.241ZM395.219 700.686C396.743 699.462 397.937 698.46 398.801 697.68C399.665 696.888 400.391 696.066 400.979 695.214C401.579 694.35 401.879 693.504 401.879 692.676C401.879 691.896 401.687 691.284 401.303 690.84C400.931 690.384 400.325 690.156 399.485 690.156C398.669 690.156 398.033 690.414 397.577 690.93C397.133 691.434 396.893 692.112 396.857 692.964H395.273C395.321 691.62 395.729 690.582 396.497 689.85C397.265 689.118 398.255 688.752 399.467 688.752C400.703 688.752 401.681 689.094 402.401 689.778C403.133 690.462 403.499 691.404 403.499 692.604C403.499 693.6 403.199 694.572 402.599 695.52C402.011 696.456 401.339 697.284 400.583 698.004C399.827 698.712 398.861 699.54 397.685 700.488H403.877V701.856H395.219V700.686Z" fill="black" />
                                        </svg>

                                        </td>
                                        <td className="room">
                                            {rooms.map((room) => (
                                            <div className="room-card">
                                                {new Date() - new Date(room.lastOnline) > 300000 ? (
                                                // Daylight saving time calculation
                                                <div className="room-box-available" key={room.id}>
                                                    <div className="room-name">{room.room}</div>
                                                    <div className="room-status-available">
                                                    Available
                                                    </div>
                                                </div>
                                                ) : (
                                                <div className="room-box-occupied" key={room.id}>
                                                    <div className="room-name">{room.room}</div>
                                                    <div className="room-status-occupied">Occupied</div>
                                                </div>
                                                )}
                                            </div>
                                            ))}
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            )
        }
    }
}


export default EleventhFloor;
