//import './twelvethFloor.css';
import './thirdFloor.css';
import React, { Component } from 'react';
import axios from 'axios';
import Tippy from '@tippy.js/react';
require('es6-promise').polyfill();

class TwelvethFloor extends Component {


    constructor(props) {
        super(props)
        this.state = {
            isLoaded: false,
            rooms: []
        }
    }


    componentDidMount() {
        this.fetchData();
        this.interval = setInterval(() => {
            this.fetchData();
        }, 10000)
    }

    fetchData() {
        axios.get(`https://findhuddle-api.azurewebsites.net/api/devices/HRH/12`)
            .then(res => {
                this.setState({
                    isLoaded: true,
                    rooms: res.data,
                })
                console.log("fetched")
            }).catch(err => {
                console.log("error")
            })
    }

    render() {
        var { isLoaded, rooms } = this.state;

        if (!isLoaded) {
            return <div>Loading...</div>

        }

        else {
            return (
                <div>
                    <div>
                        <h3 className="building">HRH 12th Floor</h3>

                        <div className="Wrap">
                            <table>
                                <tbody>
                                    <tr>
                                        <td className="Svg">
                                            <svg width="550" height="650" viewBox="0 0 666 729" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <rect x="2" y="2" width="662" height="725" fill="#EEF4FA" stroke="black" stroke-width="4" />
                                                <rect x="113" y="533" width="205" height="194" fill="#CBE0F4" stroke="black" stroke-width="4" />
                                                <path d="M161.856 625.048V630.64H167.952V632.44H161.856V638.2H168.672V640H159.672V623.248H168.672V625.048H161.856ZM174.161 622.24V640H171.977V622.24H174.161ZM189.883 632.92C189.883 633.336 189.859 633.776 189.811 634.24H179.299C179.379 635.536 179.819 636.552 180.619 637.288C181.435 638.008 182.419 638.368 183.571 638.368C184.515 638.368 185.299 638.152 185.923 637.72C186.563 637.272 187.011 636.68 187.267 635.944H189.619C189.267 637.208 188.563 638.24 187.507 639.04C186.451 639.824 185.139 640.216 183.571 640.216C182.323 640.216 181.203 639.936 180.211 639.376C179.235 638.816 178.467 638.024 177.907 637C177.347 635.96 177.067 634.76 177.067 633.4C177.067 632.04 177.339 630.848 177.883 629.824C178.427 628.8 179.187 628.016 180.163 627.472C181.155 626.912 182.291 626.632 183.571 626.632C184.819 626.632 185.923 626.904 186.883 627.448C187.843 627.992 188.579 628.744 189.091 629.704C189.619 630.648 189.883 631.72 189.883 632.92ZM187.627 632.464C187.627 631.632 187.443 630.92 187.075 630.328C186.707 629.72 186.203 629.264 185.563 628.96C184.939 628.64 184.243 628.48 183.475 628.48C182.371 628.48 181.427 628.832 180.643 629.536C179.875 630.24 179.435 631.216 179.323 632.464H187.627ZM197.662 637.984L201.742 626.848H204.07L198.91 640H196.366L191.206 626.848H193.558L197.662 637.984ZM205.403 633.376C205.403 632.032 205.675 630.856 206.219 629.848C206.763 628.824 207.507 628.032 208.451 627.472C209.411 626.912 210.475 626.632 211.643 626.632C212.795 626.632 213.795 626.88 214.643 627.376C215.491 627.872 216.123 628.496 216.539 629.248V626.848H218.747V640H216.539V637.552C216.107 638.32 215.459 638.96 214.595 639.472C213.747 639.968 212.755 640.216 211.619 640.216C210.451 640.216 209.395 639.928 208.451 639.352C207.507 638.776 206.763 637.968 206.219 636.928C205.675 635.888 205.403 634.704 205.403 633.376ZM216.539 633.4C216.539 632.408 216.339 631.544 215.939 630.808C215.539 630.072 214.995 629.512 214.307 629.128C213.635 628.728 212.891 628.528 212.075 628.528C211.259 628.528 210.515 628.72 209.843 629.104C209.171 629.488 208.635 630.048 208.235 630.784C207.835 631.52 207.635 632.384 207.635 633.376C207.635 634.384 207.835 635.264 208.235 636.016C208.635 636.752 209.171 637.32 209.843 637.72C210.515 638.104 211.259 638.296 212.075 638.296C212.891 638.296 213.635 638.104 214.307 637.72C214.995 637.32 215.539 636.752 215.939 636.016C216.339 635.264 216.539 634.392 216.539 633.4ZM225.102 628.648V636.4C225.102 637.04 225.238 637.496 225.51 637.768C225.782 638.024 226.254 638.152 226.926 638.152H228.534V640H226.566C225.35 640 224.438 639.72 223.83 639.16C223.222 638.6 222.918 637.68 222.918 636.4V628.648H221.214V626.848H222.918V623.536H225.102V626.848H228.534V628.648H225.102ZM236.916 640.216C235.684 640.216 234.564 639.936 233.556 639.376C232.564 638.816 231.78 638.024 231.204 637C230.644 635.96 230.364 634.76 230.364 633.4C230.364 632.056 230.652 630.872 231.228 629.848C231.82 628.808 232.62 628.016 233.628 627.472C234.636 626.912 235.764 626.632 237.012 626.632C238.26 626.632 239.388 626.912 240.396 627.472C241.404 628.016 242.196 628.8 242.772 629.824C243.364 630.848 243.66 632.04 243.66 633.4C243.66 634.76 243.356 635.96 242.748 637C242.156 638.024 241.348 638.816 240.324 639.376C239.3 639.936 238.164 640.216 236.916 640.216ZM236.916 638.296C237.7 638.296 238.436 638.112 239.124 637.744C239.812 637.376 240.364 636.824 240.78 636.088C241.212 635.352 241.428 634.456 241.428 633.4C241.428 632.344 241.22 631.448 240.804 630.712C240.388 629.976 239.844 629.432 239.172 629.08C238.5 628.712 237.772 628.528 236.988 628.528C236.188 628.528 235.452 628.712 234.78 629.08C234.124 629.432 233.596 629.976 233.196 630.712C232.796 631.448 232.596 632.344 232.596 633.4C232.596 634.472 232.788 635.376 233.172 636.112C233.572 636.848 234.1 637.4 234.756 637.768C235.412 638.12 236.132 638.296 236.916 638.296ZM248.716 628.984C249.1 628.232 249.644 627.648 250.348 627.232C251.068 626.816 251.94 626.608 252.964 626.608V628.864H252.388C249.94 628.864 248.716 630.192 248.716 632.848V640H246.532V626.848H248.716V628.984ZM260.141 640.216C259.133 640.216 258.229 640.048 257.429 639.712C256.629 639.36 255.997 638.88 255.533 638.272C255.069 637.648 254.813 636.936 254.765 636.136H257.021C257.085 636.792 257.389 637.328 257.933 637.744C258.493 638.16 259.221 638.368 260.117 638.368C260.949 638.368 261.605 638.184 262.085 637.816C262.565 637.448 262.805 636.984 262.805 636.424C262.805 635.848 262.549 635.424 262.037 635.152C261.525 634.864 260.733 634.584 259.661 634.312C258.685 634.056 257.885 633.8 257.261 633.544C256.653 633.272 256.125 632.88 255.677 632.368C255.245 631.84 255.029 631.152 255.029 630.304C255.029 629.632 255.229 629.016 255.629 628.456C256.029 627.896 256.597 627.456 257.333 627.136C258.069 626.8 258.909 626.632 259.853 626.632C261.309 626.632 262.485 627 263.381 627.736C264.277 628.472 264.757 629.48 264.821 630.76H262.637C262.589 630.072 262.309 629.52 261.797 629.104C261.301 628.688 260.629 628.48 259.781 628.48C258.997 628.48 258.373 628.648 257.909 628.984C257.445 629.32 257.213 629.76 257.213 630.304C257.213 630.736 257.349 631.096 257.621 631.384C257.909 631.656 258.261 631.88 258.677 632.056C259.109 632.216 259.701 632.4 260.453 632.608C261.397 632.864 262.165 633.12 262.757 633.376C263.349 633.616 263.853 633.984 264.269 634.48C264.701 634.976 264.925 635.624 264.941 636.424C264.941 637.144 264.741 637.792 264.341 638.368C263.941 638.944 263.373 639.4 262.637 639.736C261.917 640.056 261.085 640.216 260.141 640.216Z" fill="black" />
                                                <rect x="214" y="419" width="104" height="44" fill="#CBE0F4" stroke="black" stroke-width="4" />
                                                <rect x="2" y="419" width="111" height="308" fill="#CBE0F4" stroke="black" stroke-width="4" />
                                                <rect x="318" y="419" width="85" height="233" fill="#CBE0F4" stroke="black" stroke-width="4" />
                                                <rect x="403" y="419" width="87" height="233" fill="#CBE0F4" stroke="black" stroke-width="4" />
                                                <rect x="32" y="2" width="77" height="245" fill="#CBE0F4" stroke="black" stroke-width="4" />
                                                <rect x="-2.00217" y="-2" width="329.769" height="120.743" transform="matrix(-1 0 -0.00108631 -0.999999 487.898 257.743)" fill="#CBE0F4" stroke="black" stroke-width="4" />
                                                <rect x="168" y="116" width="114" height="322" transform="rotate(-90 168 116)" fill="#CBE0F4" stroke="black" stroke-width="4" />
                                                <rect x="490" y="296" width="91" height="429" transform="rotate(90 490 296)" fill="#CBE0F4" stroke="black" stroke-width="4" />
                                                <rect x="550" y="2" width="114" height="725" fill="#CBE0F4" stroke="black" stroke-width="4" />
                                                <path d="M212.884 512.116C212.396 511.628 211.604 511.628 211.116 512.116L203.161 520.071C202.673 520.559 202.673 521.351 203.161 521.839C203.649 522.327 204.441 522.327 204.929 521.839L212 514.768L219.071 521.839C219.559 522.327 220.351 522.327 220.839 521.839C221.327 521.351 221.327 520.559 220.839 520.071L212.884 512.116ZM213.25 549V513H210.75V549H213.25Z" fill="black" />
                                                <path d="M338.884 691.884C339.372 691.396 339.372 690.604 338.884 690.116L330.929 682.161C330.441 681.673 329.649 681.673 329.161 682.161C328.673 682.649 328.673 683.441 329.161 683.929L336.232 691L329.161 698.071C328.673 698.559 328.673 699.351 329.161 699.839C329.649 700.327 330.441 700.327 330.929 699.839L338.884 691.884ZM302 692.25H338V689.75H302V692.25Z" fill="black" />
                                                <path d="M191.536 484.786V488.98H196.108V490.33H191.536V494.65H196.648V496H189.898V483.436H196.648V484.786H191.536ZM203.933 485.956C205.133 485.956 206.105 486.322 206.849 487.054C207.593 487.774 207.965 488.818 207.965 490.186V496H206.345V490.42C206.345 489.436 206.099 488.686 205.607 488.17C205.115 487.642 204.443 487.378 203.591 487.378C202.727 487.378 202.037 487.648 201.521 488.188C201.017 488.728 200.765 489.514 200.765 490.546V496H199.127V486.136H200.765V487.54C201.089 487.036 201.527 486.646 202.079 486.37C202.643 486.094 203.261 485.956 203.933 485.956ZM212.638 487.486V493.3C212.638 493.78 212.74 494.122 212.944 494.326C213.148 494.518 213.502 494.614 214.006 494.614H215.212V496H213.736C212.824 496 212.14 495.79 211.684 495.37C211.228 494.95 211 494.26 211 493.3V487.486H209.722V486.136H211V483.652H212.638V486.136H215.212V487.486H212.638ZM218.835 487.738C219.123 487.174 219.531 486.736 220.059 486.424C220.599 486.112 221.253 485.956 222.021 485.956V487.648H221.589C219.753 487.648 218.835 488.644 218.835 490.636V496H217.197V486.136H218.835V487.738ZM232.408 486.136L226.468 500.644H224.776L226.72 495.892L222.742 486.136H224.56L227.656 494.128L230.716 486.136H232.408ZM238.151 484.48V482.986H241.535V496H239.879V484.48H238.151Z" fill="black" />
                                                <path d="M359.242 684.786V688.98H363.814V690.33H359.242V694.65H364.354V696H357.604V683.436H364.354V684.786H359.242ZM371.639 685.956C372.839 685.956 373.811 686.322 374.555 687.054C375.299 687.774 375.671 688.818 375.671 690.186V696H374.051V690.42C374.051 689.436 373.805 688.686 373.313 688.17C372.821 687.642 372.149 687.378 371.297 687.378C370.433 687.378 369.743 687.648 369.227 688.188C368.723 688.728 368.471 689.514 368.471 690.546V696H366.833V686.136H368.471V687.54C368.795 687.036 369.233 686.646 369.785 686.37C370.349 686.094 370.967 685.956 371.639 685.956ZM380.344 687.486V693.3C380.344 693.78 380.446 694.122 380.65 694.326C380.854 694.518 381.208 694.614 381.712 694.614H382.918V696H381.442C380.53 696 379.846 695.79 379.39 695.37C378.934 694.95 378.706 694.26 378.706 693.3V687.486H377.428V686.136H378.706V683.652H380.344V686.136H382.918V687.486H380.344ZM386.541 687.738C386.829 687.174 387.237 686.736 387.765 686.424C388.305 686.112 388.959 685.956 389.727 685.956V687.648H389.295C387.459 687.648 386.541 688.644 386.541 690.636V696H384.903V686.136H386.541V687.738ZM400.114 686.136L394.174 700.644H392.482L394.426 695.892L390.448 686.136H392.266L395.362 694.128L398.422 686.136H400.114ZM406.091 694.686C407.615 693.462 408.809 692.46 409.673 691.68C410.537 690.888 411.263 690.066 411.851 689.214C412.451 688.35 412.751 687.504 412.751 686.676C412.751 685.896 412.559 685.284 412.175 684.84C411.803 684.384 411.197 684.156 410.357 684.156C409.541 684.156 408.905 684.414 408.449 684.93C408.005 685.434 407.765 686.112 407.729 686.964H406.145C406.193 685.62 406.601 684.582 407.369 683.85C408.137 683.118 409.127 682.752 410.339 682.752C411.575 682.752 412.553 683.094 413.273 683.778C414.005 684.462 414.371 685.404 414.371 686.604C414.371 687.6 414.071 688.572 413.471 689.52C412.883 690.456 412.211 691.284 411.455 692.004C410.699 692.712 409.733 693.54 408.557 694.488H414.749V695.856H406.091V694.686Z" fill="black" />
                                                <Tippy content="HD120007">
                                                    <path key="HD120007" d="M160 259.629V215.002L203 215.049V259.676L160 259.629Z" stroke="black" strokeWidth="4" 
                                                     fill={new Date() - new Date(rooms[0].lastOnline) > 300000 ? ("#559F3B") : ("#DD0F0F")}  />
                                                </Tippy>
                                            </svg>
                                        </td>
                                        <td className="room">
                                            {rooms.map((room) => (
                                            <div className="room-card">
                                                {new Date() - new Date(room.lastOnline) > 300000 ? (
                                                // Daylight saving time calculation
                                                <div className="room-box-available" key={room.id}>
                                                    <div className="room-name">{room.room}</div>
                                                    <div className="room-status-available">
                                                    Available
                                                    </div>
                                                </div>
                                                ) : (
                                                <div className="room-box-occupied" key={room.id}>
                                                    <div className="room-name">{room.room}</div>
                                                    <div className="room-status-occupied">Occupied</div>
                                                </div>
                                                )}
                                            </div>
                                            ))}
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            )
        }
    }
}


export default TwelvethFloor;
